╔════════════════════════════════════════════════════════════════════════════════╗
║                   DEFAULT MODEL AUTO-INSTALLATION FLOW                         ║
╚════════════════════════════════════════════════════════════════════════════════╝

                                USER RUNS: delta "Hello"
                                         │
                                         ▼
                          ┌──────────────────────────────┐
                          │   Check if --model specified  │
                          └──────────────┬───────────────┘
                                         │
                          ┌──────────────┴───────────────┐
                          │                              │
                     YES  │                              │  NO
                          ▼                              ▼
                ┌──────────────────┐        ┌───────────────────────┐
                │  Use specified   │        │ Use default: qwen3-0.6b│
                │  model name      │        └──────────┬────────────┘
                └────────┬─────────┘                   │
                         │                             ▼
                         │                ┌────────────────────────┐
                         │                │ is_model_installed()?  │
                         │                └──────┬────────┬────────┘
                         │                       │        │
                         │                  YES  │        │  NO
                         │                       │        │
                         │                       ▼        ▼
                         │              ┌──────────────────────────┐
                         │              │   Model cached locally    │
                         │              │   Skip download           │
                         │              └──────────┬────────────────┘
                         │                         │
                         │              ┌──────────┴────────────┐
                         │              │                       │
                         │              ▼                       ▼
                         │    ┌─────────────────┐   ┌──────────────────────┐
                         │    │ FIRST RUN       │   │ ensure_default_model │
                         │    │ Auto-download   │   │ _installed()         │
                         │    └─────────┬───────┘   └──────────┬───────────┘
                         │              │                      │
                         │              ▼                      ▼
                         │    ┌────────────────────┐  ┌──────────────────┐
                         │    │ UI: "qwen3-0.6b:   │  │ pull_model()     │
                         │    │  Is not available" │  │ Download from HF │
                         │    └────────┬───────────┘  └─────────┬────────┘
                         │             │                        │
                         │             ▼                        ▼
                         │    ┌────────────────────┐  ┌──────────────────┐
                         │    │ UI: "Installing    │  │ Progress bar     │
                         │    │  qwen3:0.6b"       │  │ [████████] 100%  │
                         │    │ "Size: 400 MB"     │  │ 2.5 MB/s         │
                         │    └────────┬───────────┘  └─────────┬────────┘
                         │             │                        │
                         │             ▼                        ▼
                         │    ┌────────────────────┐  ┌──────────────────┐
                         │    │ Download via curl  │  │ Save to:         │
                         │    │ from Hugging Face  │  │ ~/.delta-cli/    │
                         │    └────────┬───────────┘  │ models/          │
                         │             │              └─────────┬────────┘
                         │             │                        │
                         │             ▼                        │
                         │    ┌────────────────────┐           │
                         │    │ Success?           │           │
                         │    └──────┬──────┬──────┘           │
                         │           │      │                  │
                         │       YES │      │ NO               │
                         │           │      │                  │
                         │           ▼      ▼                  │
                         │    ┌──────────┐ ┌──────────────────┐│
                         │    │ UI: "✓   │ │ UI: "✗ Failed"   ││
                         │    │ Installed│ │ "Try: delta pull ││
                         │    │ success!"│ │  qwen3:0.6b"     ││
                         │    └────┬─────┘ └──────────────────┘│
                         │         │              │             │
                         │         └──────┬───────┘             │
                         │                │                     │
                         └────────────────┼─────────────────────┘
                                          │
                                          ▼
                              ┌───────────────────────┐
                              │ resolve_model_name()  │
                              │ qwen3-0.6b →          │
                              │ Qwen3-0.6B-Q4_K_M.gguf│
                              └──────────┬────────────┘
                                         │
                                         ▼
                              ┌───────────────────────┐
                              │ get_model_path()      │
                              │ ~/.delta-cli/models/  │
                              │ Qwen3-0.6B-Q4_K_M.gguf│
                              └──────────┬────────────┘
                                         │
                                         ▼
                              ┌───────────────────────┐
                              │ UI: "Model Used:      │
                              │      qwen3-0.6b"      │
                              └──────────┬────────────┘
                                         │
                                         ▼
                              ┌───────────────────────┐
                              │ InferenceEngine::     │
                              │ load_model()          │
                              └──────────┬────────────┘
                                         │
                                         ▼
                              ┌───────────────────────┐
                              │ UI: "Loading model    │
                              │  from: /path/..."     │
                              └──────────┬────────────┘
                                         │
                                         ▼
                              ┌───────────────────────┐
                              │ UI: "Model loaded     │
                              │  successfully"        │
                              └──────────┬────────────┘
                                         │
                                         ▼
                              ┌───────────────────────┐
                              │ READY FOR INFERENCE   │
                              │ Interactive mode or   │
                              │ Single prompt mode    │
                              └───────────────────────┘


╔════════════════════════════════════════════════════════════════════════════════╗
║                              KEY FUNCTIONS                                      ║
╚════════════════════════════════════════════════════════════════════════════════╝

main.cpp:
  ├─ main()
  │  ├─ If model_name.empty():
  │  │  ├─ default_model = model_mgr.get_default_model_short_name()  // "qwen3-0.6b"
  │  │  ├─ If !is_model_installed(default_model):
  │  │  │  └─ ensure_default_model_installed(callback) ───┐
  │  │  └─ model_name = default_model                     │
  │  └─ config.model_path = get_model_path(model_name)    │
  │                                                        │
models.cpp:                                                │
  ├─ get_default_model()          // Returns "qwen3:0.6b" │
  ├─ get_default_model_short_name() // Returns "qwen3-0.6b"│
  ├─ is_model_installed(name)     // Checks ~/.delta-cli/models/│
  │                                                        │
  └─ ensure_default_model_installed(callback) ◄───────────┘
     ├─ UI::print_info("qwen3-0.6b: Is not available")
     ├─ UI::print_info("Installing qwen3:0.6b...")
     ├─ UI::print_info("Size: 400 MB | One-time download")
     ├─ pull_model("qwen3:0.6b")  // Downloads from Hugging Face
     │  ├─ get_registry_entry("qwen3:0.6b")
     │  ├─ repo_id = "unsloth/Qwen3-0.6B-GGUF"
     │  ├─ filename = "Qwen3-0.6B-Q4_K_M.gguf"
     │  ├─ url = get_hf_url(repo_id, filename)
     │  ├─ download_file(url, dest_path, callback)
     │  │  └─ libcurl with progress callback
     │  └─ Returns true/false
     └─ If success: UI::print_info("✓ Installed successfully!")
        If fail: UI::print_error("Failed. Try: delta pull qwen3:0.6b")


╔════════════════════════════════════════════════════════════════════════════════╗
║                           USER EXPERIENCE TIMELINE                              ║
╚════════════════════════════════════════════════════════════════════════════════╝

T+0s   : User types: delta "Hello"
T+0.1s : CLI parses args, no --model specified
T+0.2s : Check for qwen3-0.6b in ~/.delta-cli/models/
T+0.3s : Not found → Start auto-download
T+0.4s : Display: "qwen3-0.6b: Is not available"
T+0.5s : Display: "Installing qwen3:0.6b (Qwen 3 0.6B)"
T+0.6s : Display: "Size: 400 MB | One-time download"
T+1s   : Start libcurl download from Hugging Face
T+2s   : Progress: [█░░░░░░░░░] 10% (40 MB / 400 MB) 3.2 MB/s
T+5s   : Progress: [███░░░░░░░] 30% (120 MB / 400 MB) 3.1 MB/s
T+10s  : Progress: [██████░░░░] 60% (240 MB / 400 MB) 3.0 MB/s
T+15s  : Progress: [█████████░] 90% (360 MB / 400 MB) 2.9 MB/s
T+17s  : Progress: [██████████] 100% (400 MB / 400 MB) Done!
T+18s  : Display: "✓ Download complete!"
T+19s  : Display: "Model saved to: ~/.delta-cli/models/Qwen3-0.6B-Q4_K_M.gguf"
T+20s  : Display: "✓ Default model installed successfully!"
T+21s  : Display: "Model Used: qwen3-0.6b"
T+22s  : Display: "Loading model from: ..."
T+25s  : Model loaded (llama.cpp initialization)
T+26s  : Display: "Model loaded successfully"
T+27s  : Start inference with prompt "Hello"
T+28s  : Stream response tokens: "Hello!ĠHowĠcanĠI..." → "Hello! How can I..."
T+30s  : Complete response displayed

SUBSEQUENT RUNS (model cached):
T+0s   : User types: delta "What is AI?"
T+0.1s : CLI parses args, no --model specified
T+0.2s : Check for qwen3-0.6b in ~/.delta-cli/models/ → FOUND!
T+0.3s : Display: "Model Used: qwen3-0.6b"
T+0.4s : Display: "Loading model from: ..."
T+3s   : Model loaded (much faster, no download!)
T+4s   : Display: "Model loaded successfully"
T+5s   : Start inference, stream response
T+7s   : Complete response displayed


╔════════════════════════════════════════════════════════════════════════════════╗
║                          FILE STRUCTURE                                         ║
╚════════════════════════════════════════════════════════════════════════════════╝

delta-cli/
├── src/
│   ├── delta_cli.h                  [MODIFIED] +18 lines
│   │   ├── class ModelManager {
│   │   │   ├── static const std::string DEFAULT_MODEL_NAME;
│   │   │   ├── static std::string get_default_model();
│   │   │   ├── std::string get_default_model_short_name() const;
│   │   │   ├── bool ensure_default_model_installed(ProgressCallback);
│   │   │   └── std::string get_auto_selected_model();
│   │   └── ...
│   ├── models.cpp                   [MODIFIED] +85 lines
│   │   ├── const std::string ModelManager::DEFAULT_MODEL_NAME = "qwen3:0.6b";
│   │   ├── get_default_model() implementation
│   │   ├── get_default_model_short_name() implementation
│   │   ├── ensure_default_model_installed() implementation
│   │   └── get_auto_selected_model() implementation
│   ├── main.cpp                     [MODIFIED] +20 lines
│   │   ├── Updated model selection logic
│   │   ├── Auto-install trigger
│   │   └── Updated --help message
│   └── ...
├── README.md                        [UPDATED]
│   ├── Features: "Zero Configuration"
│   └── Quick Start: "Just run delta 'Hello'"
├── DEFAULT_MODEL_GUIDE.md           [NEW] 380 lines
├── DEFAULT_MODEL_QUICKSTART.md      [NEW] 145 lines
├── DEFAULT_MODEL_IMPLEMENTATION.md  [NEW] 450 lines
├── FINAL_DEFAULT_MODEL_SUMMARY.md   [NEW] 600+ lines
├── DEFAULT_MODEL_FLOW.txt           [NEW] This file
└── test_default_model.sh            [NEW] 150 lines


╔════════════════════════════════════════════════════════════════════════════════╗
║                          QUICK REFERENCE                                        ║
╚════════════════════════════════════════════════════════════════════════════════╝

DEFAULT MODEL:
  Name:         qwen3:0.6b (registry)
  Short Name:   qwen3-0.6b (CLI)
  File:         Qwen3-0.6B-Q4_K_M.gguf
  Size:         400 MB
  Source:       unsloth/Qwen3-0.6B-GGUF (Hugging Face)
  Quant:        Q4_K_M
  Description:  Ultra-compact multilingual model

PATHS:
  macOS/Linux:  ~/.delta-cli/models/
  Windows:      %APPDATA%\delta-cli\models\
  Android:      /data/data/com.delta.cli/files/.delta-cli/models/
  iOS:          ~/Documents/.delta-cli/models/

COMMANDS:
  Auto (default):       delta "Hello"
  Manual download:      delta pull qwen3:0.6b
  List models:          delta --list-models
  List available:       delta --list-models --available
  Override default:     delta --model llama3.1-8b "Hello"
  Help:                 delta --help

TESTING:
  Build:                ./installers/build_macos.sh
  Test suite:           ./test_default_model.sh
  Verify registry:      delta --list-models --available | grep qwen3
  Check help:           delta --help | grep "DEFAULT MODEL"

DOCUMENTATION:
  Quick start:          DEFAULT_MODEL_QUICKSTART.md
  Full guide:           DEFAULT_MODEL_GUIDE.md
  Implementation:       DEFAULT_MODEL_IMPLEMENTATION.md
  Summary:              FINAL_DEFAULT_MODEL_SUMMARY.md
  Flow diagram:         DEFAULT_MODEL_FLOW.txt (this file)

╔════════════════════════════════════════════════════════════════════════════════╗
║                            STATUS: ✅ COMPLETE                                  ║
╚════════════════════════════════════════════════════════════════════════════════╝

